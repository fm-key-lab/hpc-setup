version: '3'

vars:
  GROUP_HOME:
    sh: echo $GROUP_HOME
  GROUP_DATA: '{{.GROUP_HOME}}/public_data'
  GROUP_DBS: '{{.GROUP_DATA}}/databases'
  PUBMLST_DIR: '{{.GROUP_DBS}}/pubmlst'

# TODO: Refactor to get list of species and loop through it
# TODO: Wait on completion

tasks:
  ariba_db:
    dir: '{{.DIR}}'
    vars:
      DIR: '{{.PUBMLST_DIR}}/ariba'
    cmds:
      - bash -c '. {{.ROOT_DIR}}/tasks/scripts/ariba_pubmlst_all_species.sh {{.DIRECTORY}}'
      # - defer: rm -rf {{.DIR}}/.logs # SLURM logs