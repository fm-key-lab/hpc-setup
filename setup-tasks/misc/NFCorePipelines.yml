version: '3'

vars:
  GROUP_NFCORE_PIPELINES: $GROUP_HOME/tools/nf-core

includes:
  utils:
    taskfile: ../../lab-tasks/Taskfile.yml
    internal: true

tasks:
  # TODO: Use `--parallel-downloads`?
  default:
    deps:
      - task: check-nf-core-tools
    cmds:
      - task: utils:nxf:download-nf-core-pipeline
        vars:
          OUTDIR: '{{.GROUP_NFCORE_PIPELINES}}/bactmap'
          PIPELINE: bactmap
          VERSION: 1.0.0
      - task: utils:nxf:download-nf-core-pipeline
        vars:
          CONTAINER_SYSTEM: none
          OUTDIR: '{{.GROUP_NFCORE_PIPELINES}}/eager'
          PIPELINE: eager
          VERSION: dev
      - task: utils:nxf:download-nf-core-pipeline
        vars:
          OUTDIR: '{{.GROUP_NFCORE_PIPELINES}}/pangenome'
          PIPELINE: pangenome
          VERSION: 1.1.2
      - task: utils:nxf:download-nf-core-pipeline
        vars:
          OUTDIR: '{{.GROUP_NFCORE_PIPELINES}}/sarek'
          PIPELINE: sarek
          VERSION: 3.5.0
      - task: utils:nxf:download-nf-core-pipeline
        vars:
          OUTDIR: '{{.GROUP_NFCORE_PIPELINES}}/taxprofiler'
          PIPELINE: taxprofiler
          VERSION: 1.2.1

  check-nf-core-tools:
    internal: true
    cmds:
      - bash -c "module load nf-core && module unload nf-core" || exit 1